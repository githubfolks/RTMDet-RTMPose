# RTMDet Training Configuration (Object Detection)
# Script: train_det.py
# PURPOSE: Stabilize training on Apple MPS & eliminate mid-epoch NaNs

detection:
  model:
    architecture: "RTMDet-s"
    input_size: [640, 640]

  data:
    root: "dataset_coco"
    train_images: "train/images"
    train_annotations: "train/train.json"
    batch_size: 4
    num_workers: 0
    persistent_workers: false

  training:
    epochs: 100
    device: "cuda"
    work_dir: "train/weights_rtmdet_s_scratch"
    resume: false
    resume_from: null

    # ðŸ”’ Stabilization controls (Disabled for CUDA/Scratch)
    freeze_backbone: false
    freeze_at_epoch: 0

  optimization:
    optimizer: "AdamW"

    learning_rate:
      base_lr: 1.0e-3            # Increased for CUDA
      scheduler: "CosineAnnealing"
      warmup_steps: 300
      min_lr: 1.0e-6

    weight_decay: 0.05
    gradient_clipping: 1.0       # Standard clipping

    # ðŸ”• Mixed precision (Can enable on CUDA)
    fp16: true
    amp: true

  # ðŸš« Augmentation stabilizers
  augmentation:
    mosaic_prob: 0.0             # Disable Mosaic immediately
    close_mosaic_epochs: 40
    mixup_prob: 0.0


